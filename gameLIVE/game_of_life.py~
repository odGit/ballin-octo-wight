# -*- coding: utf-8 -*-
"""
Created on Wed Mar 26 16:54:27 2014

@author: olgis
Conway's Game of Life.

TO DO: not displayed on all field if 600x480
TO DO: save playground valuse to a [n-3, n-2, n-1, n]. Because some of loops
repeat in period of 3 (Oscillators: Pulsar) 

"""
import game_logic_v2 as gl
import pygame          

playground_size = [100, 100] #width, height
screen_size = (600, 480)
cell_size = [screen_size[0] // playground_size[0], 
             screen_size[1] // playground_size[1] ]


#total number of cells on playground
total_num =  playground_size[0] * playground_size[1]   

#initial number of randomly populated cells
seed_num = total_num // 10

#background colour
back_colour = (0, 0, 0)
cell_colour = (0, 75, 255)

    
        
if __name__ == '__main__':


    previous, playground = gl.seed(seed_num, total_num) #init playground
    neighbours_dict = gl.get_neighbours(playground_size, total_num)
    
    cell_width =  screen_size[0] // playground_size[0]
    cell_height = screen_size[1] // playground_size[1]

    pygame.init()
    
    screen = pygame.display.set_mode(screen_size)
    pygame.display.set_caption("Conway's Game of Life")
    
    
    mainloop = True

    
    while mainloop:
        screen.fill(back_colour) #fill the background with BLACK
        
        for event in pygame.event.get():
            if event.type == pygame.QUIT:
                mainloop = False #pygame window closed by user
                print "Game over by QUIT"
            elif event.type == pygame.KEYDOWN:
                if event.key == pygame.K_ESCAPE:
                    mainloop = False #user pressed ESC
                    print "Game over by user"
        
        #drawing rectangules on a screen         
        gl.drawing_obj(screen, playground_size, cell_size, playground,
                       cell_colour)       
        

        #updating values of n, n-1 and n-2 playgrounds
        before_previous = previous #n-2 playground
        previous = playground[:] #n-1 playground 
        playground = gl.values_update(playground, neighbours_dict) #n 
        
        #check if the game is over
        mainloop = gl.game_over(mainloop, playground,
                                previous, before_previous)

        
        pygame.time.delay(300)  #delay in mSeconds
        pygame.display.update()
